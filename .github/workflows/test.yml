name: ğŸ§ª Unit Test Workflow

on:
  workflow_call:

jobs:
  test:
    name: ğŸ§ª Run Unit Tests
    runs-on: ubuntu-latest

    steps:
      - name: ğŸ“¥ Checkout Code
        uses: actions/checkout@v4

      - name: ğŸ“‚ Setup Environment
        uses: ./.github/actions/env/setup
        with:
          backend_env: ${{ inputs.backend_env }}
          mysql_env: ${{ inputs.mysql_env }}
          test_env: ${{ inputs.test_env }}

      - name: ğŸ³ Setup Docker
        uses: ./.github/actions/docker/setup

      - name: ğŸ—ï¸ Build Container for Testing
        run: make build

      - name: ğŸ’¤ Wait for DB to settle
        run: sleep 20

      - name: ğŸ Setup Python
        uses: ./.github/actions/python/setup

      - name: ğŸ§ª Run Tests
        uses: ./.github/actions/python/run-tests
